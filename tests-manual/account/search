#!/usr/bin/env python3
import ocflib.account.search as search
import ocflib.ucb.directory as directory

if __name__ == '__main__':
    print('Users with CalNet UID 1034192: {}'.format(
        search.users_by_calnet_uid(1034192)))

    print('Attributes for user ckuehl:\n{}'.format(
        search.user_attrs('ckuehl')))

    print('Attributes for user 1034192 (from CalNet):\n{}'.format(
        search.user_attrs_ucb('1034192')))

    print('Attributes for user nonexist should be None:\n{}'.format(
        search.user_attrs('nonexist')))

    for user in ('ckuehl', 'nonexist'):
        print('User {} exists: {}'.format(user, search.user_exists(user)))

    for user in ('ckuehl', 'ggroup'):
        print('User {} is group: {}'.format(user, search.user_is_group(user)))

    """ Note: the following tests will fail if the password file in
        UCB_LDAP_PASSWORD_PATH does not exist or is invalid
    """
    user = search.user_attrs_ucb(1101587)  # jvperrin's uid
    print('User with uid {} has uid {}'.format(user['uid'], str(1101587)))

    print('{} should be in user[\'objectClass\']: {}'.format('person', 'person' in user['objectClass']))

    print('Real query with invalid uid 9999999 should be empty: {}'.format(
        (None or '').lower() == (directory.name_by_calnet_uid(9999999) or '').lower()))
